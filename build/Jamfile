#
# Copyright (c) 2025 Vinnie Falco (vinnie dot falco at gmail dot com)
#
# Distributed under the Boost Software License, Version 1.0. (See accompanying
# file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)
#
# Official repository: https://github.com/cppalliance/corosio
#

import config : requires ;

constant c20-requires :
    [ requires
    cxx20_constexpr
    ]
    ;

path-constant COROSIO_ROOT : .. ;

project boost/corosio
  : requirements
    $(c20-requires)
    <define>BOOST_COROSIO_SOURCE
    <toolset>gcc:<cxxflags>-fcoroutines
  : common-requirements
    <link>shared:<define>BOOST_COROSIO_DYN_LINK
    <link>static:<define>BOOST_COROSIO_STATIC_LINK
  : usage-requirements
    <define>BOOST_COROSIO_NO_LIB
  : source-location $(COROSIO_ROOT)
  ;

alias corosio_sources : [ glob-tree-ex $(COROSIO_ROOT)/src/corosio : *.cpp ] ;

lib boost_corosio
  : corosio_sources
  : requirements
    <library>/boost/capy//boost_capy
    <library>/boost/buffers//boost_buffers
    <include>$(COROSIO_ROOT)/include
  : usage-requirements
    <library>/boost/capy//boost_capy
    <library>/boost/buffers//boost_buffers
    <include>$(COROSIO_ROOT)/include
  ;

boost-install boost_corosio ;
